# 🛑 SISTEMA DE ENFORCEMENT AUTOMÁTICO - CLAUDE CODE

## ⚠️ REGLAS CRÍTICAS - VIOLACIÓN = DETENCIÓN INMEDIATA

### 🔴 CHECKPOINT OBLIGATORIO ANTES DE CUALQUIER CÓDIGO

**ANTES de escribir CUALQUIER línea de código, DEBO:**

```bash
# PASO 1: VERIFICAR ARCHIVO ACTUAL
wc -l [archivo_a_modificar]
# Si > 250 líneas → STOP → Crear nuevo archivo

# PASO 2: CALCULAR IMPACTO
# ¿Cuántas líneas agregaré? Si > 50 → STOP → Crear componente separado

# PASO 3: VALIDAR ARQUITECTURA
# ¿Es un preview? → DEBE ir en /components/editor/preview/[Name]Preview.tsx
# ¿Es un editor? → DEBE ir en /components/editor/[Name]Editor.tsx
```

## 📊 ARCHIVOS EN VIOLACIÓN ACTUAL (NO TOCAR - SOLO NUEVOS MÓDULOS)

| Archivo | Líneas | Estado |
|---------|--------|--------|
| EditorPreview.tsx | 1,763 | ❌ CONGELADO - NO AGREGAR MÁS |
| EditorSidebar.tsx | ??? | ⚠️ VERIFICAR ANTES DE MODIFICAR |

## ✅ ESTRUCTURA OBLIGATORIA PARA NUEVOS MÓDULOS

```
components/
├── editor/
│   ├── modules/           # 🆕 NUEVA CARPETA PARA MÓDULOS
│   │   ├── [ModuleName]/
│   │   │   ├── [ModuleName]Editor.tsx      (<300 líneas)
│   │   │   ├── [ModuleName]Preview.tsx     (<300 líneas)
│   │   │   ├── [ModuleName]Config.tsx      (<300 líneas)
│   │   │   ├── [ModuleName]Types.ts        (<100 líneas)
│   │   │   └── index.ts                    (exports)
```

## 🤖 AUTO-VERIFICACIÓN EN CADA ARCHIVO NUEVO

```typescript
/**
 * @file [NombreArchivo].tsx
 * @max-lines 300
 * @module [NombreModulo]
 * @created [Fecha]
 * 
 * CHECKPOINT VALIDATIONS:
 * ✅ File will be < 300 lines
 * ✅ Following modular architecture
 * ✅ Separated preview/editor/config
 * ✅ Types in separate file
 */
```

## 🔥 SCRIPT DE VALIDACIÓN AUTOMÁTICA

```bash
#!/bin/bash
# validate-module.sh

FILE=$1
MAX_LINES=300

if [ ! -f "$FILE" ]; then
    echo "✅ New file - will create with proper structure"
    exit 0
fi

LINES=$(wc -l < "$FILE")
if [ $LINES -gt $MAX_LINES ]; then
    echo "❌ ERROR: File has $LINES lines (max: $MAX_LINES)"
    echo "🛑 STOPPED: Cannot add code to this file"
    echo "✅ SOLUTION: Create new module in components/editor/modules/"
    exit 1
fi

echo "✅ File has $LINES lines - can add up to $((MAX_LINES - LINES)) more lines"
```

## 📋 CHECKLIST MANDATORIO PARA CADA MÓDULO

- [ ] ¿El archivo destino tiene < 250 líneas?
- [ ] ¿Mi código agregará < 50 líneas?
- [ ] ¿Estoy usando la estructura modular?
- [ ] ¿Separé preview, editor y config?
- [ ] ¿Los types están en archivo separado?
- [ ] ¿Seguí el patrón de carpetas modules/?

**SI ALGUNO ES NO → STOP → CREAR MÓDULO SEPARADO**

## 🎯 EJEMPLO DE MÓDULO CORRECTO

```
components/editor/modules/Gallery/
├── GalleryEditor.tsx      # 180 líneas - Configuración
├── GalleryPreview.tsx     # 120 líneas - Visualización
├── GalleryConfig.tsx      # 95 líneas - Panel de config
├── GalleryTypes.ts        # 25 líneas - Tipos
└── index.ts              # 5 líneas - Exports
```

## ⚠️ RECORDATORIO CRÍTICO

**EditorPreview.tsx está CONGELADO**
- NO agregar más imports
- NO agregar más casos al switch
- NO agregar más funciones
- Para nuevos módulos → Crear en /modules/[ModuleName]/

## 🚀 COMANDO DE INICIO DE MÓDULO

Cuando el usuario pida un nuevo módulo, PRIMERO ejecutar:
```bash
# Crear estructura base
mkdir -p components/editor/modules/[ModuleName]
touch components/editor/modules/[ModuleName]/[ModuleName]Editor.tsx
touch components/editor/modules/[ModuleName]/[ModuleName]Preview.tsx
touch components/editor/modules/[ModuleName]/[ModuleName]Config.tsx
touch components/editor/modules/[ModuleName]/[ModuleName]Types.ts
touch components/editor/modules/[ModuleName]/index.ts
```

---
ÚLTIMA ACTUALIZACIÓN: 2025-01-15
RAZÓN: EditorPreview.tsx violó límite de 300 líneas (1,763 actual)